spring:
  application:
    name: service-provider
  datasource:
    driver-class-name: com.mysql.cj.jdbc.Driver
    url: jdbc:mysql://172.31.38.196:3306/seata?serverTimezone=UTC&useSSL=false&allowPublicKeyRetrieval=true
    username: seata
    password: 123456
  cloud:
    nacos:
      server-addr: 172.31.38.196:8848
      config:
        file-extension: yaml
        namespace: public
        group: DEFAULT_GROUP
        refresh-enabled: false
      discovery:
        group: DEFAULT_GROUP
        # 重要配置：防止注册过早失败
        register-enabled: true
        enabled: true
        # 心跳和重试配置
        heart-beat-interval: 5000  # 心跳间隔（毫秒）
        heart-beat-timeout: 15000  # 心跳超时
        ip-delete-timeout: 30000   # 实例删除超时
    sentinel:
      transport:
        dashboard: 172.31.38.196:8080
      eager: true
  rabbitmq:
    host: 172.31.38.196
    port: 5672
    virtual-host: /
    stream:
      username: guest
      password: guest
  redis:
    host: 172.31.38.196
    port: 6379
    database: 0
    password: 123456
    timeout: 2000ms
    lettuce:
      pool:
        max-active: 20
        max-idle: 10
        min-idle: 5
        max-wait: 1000ms
feign:
  sentinel:
    enabled: false
mybatis:
  mapper-locations: classpath:mapper/*.xml
  type-aliases-package: org.example.serviceprovider.entity
seata:
  # 启用 Seata
  enabled: true
  # 应用ID
  application-id: seata-server
  # 事务组（必须是唯一的）
  tx-service-group: service-provider-tx-group
  # 服务配置 - 解决你的错误
  service:
    vgroup-mapping:
      service-provider-tx-group: default  # 这个必须要有！
    # 直接连接，避免注册中心问题
    grouplist:
      default: 127.0.0.1:8091  # 改为你的 Seata Server IP
  # 暂时禁用注册中心，使用直连
  registry:
    type: file
